name: Arduino Library Quality Check
# Description: Running Arduino Lint and Arduino CI
# NOTICE: This shared workflow is likely used by several others in this folder

on:
  workflow_call:
    inputs:
      expect-arduino-examples:
        description: Should examples be expected ?
        required: false
        type: boolean
        default: true
      lint-lib-manager-check:
        description: Configuration of the checks for publication on the 'Arduino Library Manager'. Options are "false", "submit", and "update".
        required: false
        type: string
        default: "false"
      lint-compliance-level:
        description: Configure how strict the tool is about which checks are considered errors vs warnings if they don't pass. Options are "strict", "specification", and "permissive".
        required: false
        type: string
        default: "specification"
      lint-project-type:
        description: Configures which types of projects to check, along with their subprojects. Options are "sketch", "library", "platform", "package-index" and "all".
        required: false
        type: string
        default: "all"

jobs:
  arduino-lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: arduino/arduino-lint-action@v2
        with:
          library-manager: ${{ inputs.lint-lib-manager-check }}
          compliance: ${{ inputs.lint-compliance-level }}
          project-type: ${{ inputs.lint-project-type }}

  arduino-ci:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: Arduino-CI/action@stable-1.x
        env:
          EXPECT_EXAMPLES: ${{ inputs.expect-arduino-examples }}
